package com.lcvc.ebuy_maven_ssm.web.shop;import com.lcvc.ebuy_maven_ssm.model.Customer;import com.lcvc.ebuy_maven_ssm.service.CustomerService;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.ResponseBody;import javax.annotation.Resource;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpSession;import java.util.HashMap;import java.util.Map;@Controller@RequestMapping(value = "/shop")public class SigninSignupController {	@Resource	private CustomerService customerService;	/*	 * 显示登录页面，该登录页面是使用Ajax进行登录	 */	@RequestMapping(value = "/toSignin", method = RequestMethod.GET)	public String toSignin() {		return "/jsp/shop/signin.jsp";	}	/*	 * 用于判断登录	 */	@ResponseBody	@RequestMapping(value = "/doSignin", method = RequestMethod.POST)	public Map<String, Object> doSignin(String username, String password, HttpSession session) {		Map<String, Object> map = new HashMap<String, Object>();		Customer customer = customerService.login(username, password);		if (customer != null) {			session.setAttribute("customer", customer);			map.put("status", 1);		} else {			map.put("status", 0);			map.put("myMessage", "登录失败:密码错误");		}		return map;	}	//注销登录	@RequestMapping(value = "/logout", method = RequestMethod.GET)	public String doLogout(HttpSession session) {		session.removeAttribute("customer");		return "/jsp/shop/signin.jsp";	}	//跳转到用户注册页面	@RequestMapping(value = "/signup", method = RequestMethod.GET)	public String toAddAdmin(HttpServletRequest request) {		return "/jsp/shop/signup.jsp";	}	//执行用户注册操作	@RequestMapping(value = "/doSignup", method = RequestMethod.POST)	public String doSignup(Model model, Customer customer) {		customer.setUsername(customer.getUsername().trim());		customer.setPassword(customer.getPassword().trim());		customer.setName(customer.getName().trim());		if (customer.getUsername().length()==0){			model.addAttribute("myMessage", "添加用户账户失败：账户名不能为空");		}else if (customer.getPassword().length()==0){			model.addAttribute("myMessage", "添加用户账户失败：密码不能为空");		}else if (customer.getName().length()==0){			model.addAttribute("myMessage", "添加用户账户失败：网名不能为空");		}else if (customerService.existsCustomer(customer.getUsername())) {			model.addAttribute("myMessage", "账户用建失败：账户名已存在，请选择其他的账户名！");		}else {			customerService.saveCustomer(customer);			model.addAttribute("myMessage", "添加用户账户成功！");		}		return "/jsp/shop/signup.jsp";	}}